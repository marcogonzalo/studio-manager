---
description: Workflow when user asks to generate the PR (generate the PR, create PR, etc.)
alwaysApply: true
---

# Workflow: Generate the PR / Push Changes

## Two scenarios

1. **Generate PR** (or equivalent: "generate the PR", "create the PR", "open the PR", "prepare the PR"): Run all steps including creating the PR.

2. **Push changes** (or equivalent: "sube los cambios", "push changes", "commit and push", "subir cambios"): Run all steps **except** creating the PR (stop after pushing to remote).

When either scenario is triggered, run **in this order**:

## 1. Clean

- Remove `console.log`, `debugger`, and debug code.
- Remove unused imports and variables.
- Review and remove temporary or test files that should not be in the repo.
- Fix linter warnings in touched files.

## 2. Verify and fix formatting (Prettier)

- Run the formatter (e.g. `npm run format` or `npx prettier --write .`). Verify there are no format-only diffs left; fix any reported issues.
- Do this **before** running tests and build so the build sees the final formatted code.

## 3. Verify everything works

- **Tests:** Run the test suite (e.g. `npm run test`). Fix failures before continuing. Minimum 80% coverage for new code (per project standards).
- **Build:** Run the build (e.g. `npm run build`). Ensure it completes without errors.
- Do not proceed to the next step if tests or build fail.

## 4. Update documentation

- Update `memory-bank/progress.md` (or equivalent) with what was completed on the branch.
- Update README, API docs, or guides if the change requires it.
- Include these changes in the documentation commit or in previous commits if already ready.

## 5. Commits

- Review `git status` and ensure all relevant changes are included.
- Create commits using **Conventional Commits** (`feat:`, `fix:`, `chore:`, `docs:`, etc.).
- Clear, descriptive messages per logical set of changes.
- Optional: a final commit `docs: update progress and release notes` if documentation was updated in step 4.

## 6. Push to remote

- Push the branch to the remote.

## 7. Create the PR (only if user asked to "generate PR")

- **Only execute this step if the user explicitly asked to generate/create the PR.**
- **If the user only asked to "push changes" or "subir cambios", skip this step.**
- Create the Pull Request with:
  - Descriptive title.
  - Description: summary of changes, modified/new files, build and test status, coverage.
  - Review checklist or test plan if applicable.
- **Use the GitHub MCP** (`user-github` server, tool `create_pull_request`) to create the PR. Required args: `owner`, `repo`, `title`, `head` (branch name), `base` (e.g. `main`), and `body` (description). If MCP is unavailable, provide the PR content and compare URL for manual creation.

---

**Summary:**

- **Generate PR:** Branch (ensure not on main) → Clean → Format (Prettier) → Tests + Build → Documentation → Commits → Push → PR
- **Push changes:** Branch (ensure not on main) → Clean → Format (Prettier) → Tests + Build → Documentation → Commits → Push (stop here)

Do not skip steps; if something fails, fix it before continuing.
